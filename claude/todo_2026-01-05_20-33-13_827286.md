# Todo List: Phase 1.3 - Activity & History Access

**Generated**: 2026-01-05 20:33:13 America/Toronto
**Task Summary**: Implement work package activity and comment access to enable Claude to understand discussions and change history

## Context

This implements Phase 1.3 from ROADMAP.md, which is part of the CRITICAL foundation for agentic capabilities.

**Goal**: Enable Claude to access comments, discussions, and change history for work packages to understand context and team discussions.

**Why This Matters**: Without access to comments and history, Claude cannot understand the full context of decisions, discussions, or why changes were made. This is essential for providing informed recommendations and understanding project dynamics.

**Dependencies**:
- Phase 1.1 (Bulk Data Loading) - COMPLETED ✅
- Phase 1.2 (Relationships & Hierarchy) - COMPLETED ✅

## Tasks

### 1. Type Definitions for Activities and Comments

- [x] Add `Activity` interface - **Completed: 2026-01-06 20:35:00**
  - File(s): `src/types.ts`
  - Complexity: moderate
  - Dependencies: none
  - Details: Added Activity with user, timestamp, comment, details array for changes

- [x] Add `Comment` interface (if needed as separate type) - **Completed: 2026-01-06 20:35:00**
  - File(s): `src/types.ts`
  - Complexity: simple
  - Dependencies: Task 1a
  - Details: Comment is embedded in Activity interface, no separate type needed

- [x] Update imports and exports - **Completed: 2026-01-06 20:35:00**
  - File(s): `src/types.ts`
  - Complexity: simple
  - Dependencies: Tasks 1a, 1b
  - Details: Activity interface exported automatically

### 2. API Client Methods for Activities

- [x] Add `listWorkPackageActivities` method - **Completed: 2026-01-06 20:38:00**
  - File(s): `src/openproject-client.ts`
  - Complexity: moderate
  - Dependencies: Task 1
  - Details: Added method to fetch all activities with pagination support
  - Endpoint: `/api/v3/work_packages/{id}/activities`
  - Return type: Collection<Activity>

- [x] Add `getWorkPackageComments` helper method - **Completed: 2026-01-06 20:38:00**
  - File(s): `src/openproject-client.ts`
  - Complexity: simple
  - Dependencies: Task 2a
  - Details: Filters activities to only return those with comments

### 3. MCP Tools for Activities

- [x] Add `list_work_package_activities` tool - **Completed: 2026-01-06 20:42:00**
  - File(s): `src/index.ts`
  - Complexity: simple
  - Dependencies: Task 2a
  - Details: Added tool definition and handler for chronological activity log
  - Parameters: workPackageId (required), pageSize (optional), offset (optional)

- [x] Add `get_work_package_comments` tool - **Completed: 2026-01-06 20:42:00**
  - File(s): `src/index.ts`
  - Complexity: simple
  - Dependencies: Task 2b
  - Details: Added tool definition and handler for comments-only access
  - Parameters: workPackageId (required)

### 4. Documentation Updates

- [x] Update README.md with activity tools - **Completed: 2026-01-06 20:45:00**
  - File(s): `README.md`
  - Complexity: simple
  - Dependencies: Task 3
  - Details: Added "Work Package Activities & Comments" section with both tools documented

- [x] Add activity/comment usage examples - **Completed: 2026-01-06 20:45:00**
  - File(s): `README.md`
  - Complexity: simple
  - Dependencies: Task 4a
  - Details: Added "Activity History & Team Collaboration" section in Advanced Analytical Tasks
  - Example queries included for reading discussions and change history

### 5. Build and Verification

- [x] Verify TypeScript compilation - **Completed: 2026-01-06 20:43:00**
  - File(s): N/A
  - Complexity: simple
  - Dependencies: All code tasks
  - Details: Build successful with no errors

- [x] Verify tool definitions are correct - **Completed: 2026-01-06 20:45:00**
  - File(s): N/A
  - Complexity: simple
  - Dependencies: Task 3
  - Details: All tool schemas and descriptions verified

## Verification

- [x] Build succeeds without TypeScript errors - **Completed: 2026-01-06 20:43:00**
- [x] New tools appear in MCP tool list (2 new tools) - **Completed: 2026-01-06 20:45:00** (list_work_package_activities, get_work_package_comments)
- [x] Activity data structures are correctly typed - **Completed: 2026-01-06 20:45:00** (Activity interface with proper HAL+JSON structure)
- [x] Can read comment threads - **Completed: 2026-01-06 20:45:00** (via get_work_package_comments)
- [x] Can see change history - **Completed: 2026-01-06 20:45:00** (via list_work_package_activities)
- [x] Documentation is complete and accurate - **Completed: 2026-01-06 20:45:00** (README updated with all activity tools)

## Notes

**API Endpoints**:
- `/api/v3/work_packages/{id}/activities` - Get all activities for a work package
- Activities include: comments, status changes, field updates, etc.
- Each activity has a user, timestamp, and details of what changed

**Activity Types in OpenProject**:
- Comments/Notes - User-added comments
- Status changes - e.g., "New" → "In Progress"
- Field updates - e.g., assignee changed, due date updated
- Relationship changes - e.g., parent changed, blocker added

**Data Structure Considerations**:
- Activities are returned in chronological order (oldest first or newest first based on sorting)
- Comments are embedded in activities with format/raw/html structure
- Change details are in a "details" array showing old → new values
- Need to handle pagination for work packages with many activities

**Success Criteria**:
When complete, Claude should be able to:
- Read all comments on a work package
- See the full change history (who changed what, when)
- Understand discussions and decisions made in comments
- Track how work packages evolved over time
- Identify who made specific changes
- Foundation ready for more advanced analysis (sentiment, decision tracking)
